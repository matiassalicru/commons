"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.StatusContainer=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator")),_typeof2=_interopRequireDefault(require("@babel/runtime/helpers/typeof")),_asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator")),_slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray")),_react=require("react"),_propTypes=_interopRequireDefault(require("prop-types")),_reactI18next=require("react-i18next"),_statusSelector=require("../../../status-selector"),_concatenatedStatus=_interopRequireDefault(require("../../../../utils/concatenatedStatus")),_eventTaskPanel=_interopRequireWildcard(require("../utils/eventTaskPanel")),_play=_interopRequireDefault(require("../utils/play")),_UserProvider=require("../../../../providers/UserProvider"),_task=require("../constants/task"),_status=require("../constants/status"),_jsxRuntime=require("react/jsx-runtime");function _getRequireWildcardCache(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(_getRequireWildcardCache=function(a){return a?c:b})(a)}function _interopRequireWildcard(a,b){if(!b&&a&&a.__esModule)return a;if(null===a||"object"!==(0,_typeof2.default)(a)&&"function"!=typeof a)return{default:a};var c=_getRequireWildcardCache(b);if(c&&c.has(a))return c.get(a);var d={},e=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in a)if("default"!=f&&Object.prototype.hasOwnProperty.call(a,f)){var g=e?Object.getOwnPropertyDescriptor(a,f):null;g&&(g.get||g.set)?Object.defineProperty(d,f,g):d[f]=a[f]}return d.default=a,c&&c.set(a,d),d}var ModalPortal=(0,_react.lazy)(function(){return Promise.resolve().then(function(){return _interopRequireWildcard(require("../../../modal-portal"))}).then(function(a){return{default:a.ModalPortal}})}),StatusContainerMemo=function(a){var b=a.taskId,c=a.getLinks,d=a.dataCounter,e=a.isLargeTask,f=a.updateStatus,g=a.currentStatus,h=a.taskTitle,i=void 0===h?"":h,j=a.handleShowError,k=(0,_react.useContext)(_UserProvider.UserContext),l=k.isClient,m=k.settings,n=(0,_react.useState)({}),o=(0,_slicedToArray2.default)(n,2),p=o[0],q=o[1],r=(0,_react.useState)(!1),s=(0,_slicedToArray2.default)(r,2),u=s[0],v=s[1],w=(0,_react.useState)(""),x=(0,_slicedToArray2.default)(w,2),y=x[0],z=x[1],A=(0,_reactI18next.useTranslation)(["task_panel","modals"]),B=A.t,t=(0,_react.useCallback)(function(a,b){(0,_concatenatedStatus.default)(a).hasDependencies?(z(b),v(!0)):(C(b),D(b),f({status:b}))},[d]),C=(0,_react.useCallback)(function(a){a===_status.STATUS_FINISHED&&(0,_play.default)(b)&&(0,_eventTaskPanel.default)(_eventTaskPanel.ACTION_STOP_COUNTER_TIME_KEEPER,{task:{_id:b}})},[b]),D=(0,_react.useCallback)(function(a){if(a===_status.STATUS_FINISHED&&d.playData&&"function"==typeof d.stop){var c=d.playData,e=c.taskId,f=c.currentTime,g=c.counterId;b+""===e+""&&d.stop({taskId:b,counterId:g,currentTime:f});var h=new CustomEvent(_status.LISTENER_TASK_FINISHED,{detail:{taskId:b}});window.dispatchEvent(h)}},[d]),E=(0,_react.useCallback)(function(){var a=(0,_asyncToGenerator2.default)(_regenerator.default.mark(function b(a){var d,e;return _regenerator.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.prev=0,b.next=3,c();case 3:d=b.sent,e=d.data,q(e.taskLinks),t(e.taskLinks,a),b.next=12;break;case 9:b.prev=9,b.t0=b["catch"](0),j();case 12:case"end":return b.stop();}},b,null,[[0,9]])}));return function(){return a.apply(this,arguments)}}(),[d]),F=(0,_react.useCallback)(function(){var a=(0,_concatenatedStatus.default)(p);v(!1),C(y),D(y),f({status:y,linkOption:{option:"delete_".concat(a.type,"_link"),filterByStatus:a.status,change_type:"status"}})},[p,y,d]),G=(0,_react.useCallback)(function(){return v(!1)},[]),H=(0,_react.useMemo)(function(){return{accept:B("modals:accept"),cancel:B("modals:cancel")}},[]),I=e?_task.LARGE_SIZE:_task.SMALL_SIZE,J=(0,_react.useMemo)(function(){return!0===(null===m||void 0===m?void 0:m.allow_in_design_status)},[m]),K=(0,_react.useMemo)(function(){return!0===(null===m||void 0===m?void 0:m.allow_in_revision_status)},[m]);return(0,_jsxRuntime.jsxs)(_jsxRuntime.Fragment,{children:[(0,_jsxRuntime.jsx)(_statusSelector.StatusSelector,{width:4,ableToEdit:!l,boxWidth:I,isInDesignStatusAllowed:J,isInReviewStatusAllowed:K,currentStatus:g,updateStatus:E}),(0,_jsxRuntime.jsx)(_react.Suspense,{fallback:(0,_jsxRuntime.jsx)("div",{}),children:u&&(0,_jsxRuntime.jsx)(ModalPortal,{variant:"danger",closeModal:G,translations:H,clickButtonAccept:F,elementId:"#modals-portal-taskpanel",clickButtonCancel:G,title:B("task_panel:concatenated_dependencies_title_modal"),textContent:B("task_panel:concatenated_dependencies",{taskName:i}),children:(0,_jsxRuntime.jsx)("b",{children:B("task_panel:concatenated_dependencies_question_modal")})})})]})},StatusContainer=(0,_react.memo)(StatusContainerMemo,function(a,b){return a.taskTitle===b.taskTitle&&a.currentStatus===b.currentStatus&&a.dataCounter===b.dataCounter});exports.StatusContainer=StatusContainer,StatusContainerMemo.propTypes={taskId:_propTypes.default.number.isRequired,getLinks:_propTypes.default.func.isRequired,updateStatus:_propTypes.default.func.isRequired,currentStatus:_propTypes.default.string.isRequired,taskTitle:_propTypes.default.string.isRequired,handleShowError:_propTypes.default.func.isRequired,isLargeTask:_propTypes.default.bool.isRequired,dataCounter:_propTypes.default.object.isRequired};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJNb2RhbFBvcnRhbCIsImxhenkiLCJ0aGVuIiwibW9kdWxlIiwiZGVmYXVsdCIsIlN0YXR1c0NvbnRhaW5lck1lbW8iLCJ0YXNrSWQiLCJnZXRMaW5rcyIsImRhdGFDb3VudGVyIiwiaXNMYXJnZVRhc2siLCJ1cGRhdGVTdGF0dXMiLCJjdXJyZW50U3RhdHVzIiwidGFza1RpdGxlIiwiaGFuZGxlU2hvd0Vycm9yIiwidXNlQ29udGV4dCIsIlVzZXJDb250ZXh0IiwiaXNDbGllbnQiLCJzZXR0aW5ncyIsInVzZVN0YXRlIiwibGlua3MiLCJzZXRMaW5rcyIsInNob3dNb2RhbCIsInNldFNob3dNb2RhbCIsInN0YXR1c1RvVXBkYXRlIiwic2V0U3RhdHVzVG9VcGRhdGUiLCJ1c2VUcmFuc2xhdGlvbiIsInQiLCJ2ZXJpZnlDb25jYXRlbmF0ZSIsInVzZUNhbGxiYWNrIiwiZGF0YWxpbmtzIiwibmV3U3RhdHVzIiwid2FybkNvbmNhdGVuYXRlZCIsImhhc0RlcGVuZGVuY2llcyIsInN0b3BDb3VudGVyIiwiaGFuZGxlVGFza0ZpbmlzaGVkIiwic3RhdHVzIiwiU1RBVFVTX0ZJTklTSEVEIiwiaXNQbGF5QWN0aXZlIiwiZXZlbnRUYXNrUGFuZWwiLCJBQ1RJT05fU1RPUF9DT1VOVEVSX1RJTUVfS0VFUEVSIiwidGFzayIsIl9pZCIsInBsYXlEYXRhIiwic3RvcCIsInRhc2tJZFdpdGhQbGF5IiwiY3VycmVudFRpbWUiLCJjb3VudGVySWQiLCJ0YXNrRmluaXNoZWRFdmVudCIsIkN1c3RvbUV2ZW50IiwiTElTVEVORVJfVEFTS19GSU5JU0hFRCIsImRldGFpbCIsIndpbmRvdyIsImRpc3BhdGNoRXZlbnQiLCJoYW5kbGVVcGRhdGVTdGF0dXMiLCJkYXRhIiwidGFza0xpbmtzIiwiaGFuZGxlQWNjZXB0IiwiQ09OQ0FURU5BVEVEX1VUSUwiLCJsaW5rT3B0aW9uIiwib3B0aW9uIiwidHlwZSIsImZpbHRlckJ5U3RhdHVzIiwiY2hhbmdlX3R5cGUiLCJoYW5kbGVDbG9zZU1vZGFsIiwidHJhbnNsYXRlc01vZGFsIiwidXNlTWVtbyIsImFjY2VwdCIsImNhbmNlbCIsInN0YXR1c1dpZHRoIiwiTEFSR0VfU0laRSIsIlNNQUxMX1NJWkUiLCJpc0luRGVzaWduU3RhdHVzQWxsb3dlZCIsImFsbG93X2luX2Rlc2lnbl9zdGF0dXMiLCJpc0luUmV2aWV3U3RhdHVzQWxsb3dlZCIsImFsbG93X2luX3JldmlzaW9uX3N0YXR1cyIsInRhc2tOYW1lIiwiU3RhdHVzQ29udGFpbmVyIiwibWVtbyIsInByZXZQcm9wcyIsIm5leHRQcm9wcyIsInByb3BUeXBlcyIsIlByb3BUeXBlcyIsIm51bWJlciIsImlzUmVxdWlyZWQiLCJmdW5jIiwic3RyaW5nIiwiYm9vbCIsIm9iamVjdCJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3Rhc2stcm93L3NyYy9jb250YWluZXJzL1N0YXR1c0NvbnRhaW5lci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB1c2VNZW1vLCB1c2VTdGF0ZSwgU3VzcGVuc2UsIHVzZUNvbnRleHQsIHVzZUNhbGxiYWNrLCBtZW1vLCBsYXp5IH0gZnJvbSAncmVhY3QnXG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnXG4vLyBDb21wb25lbnRzXG5pbXBvcnQgeyB1c2VUcmFuc2xhdGlvbiB9IGZyb20gJ3JlYWN0LWkxOG5leHQnXG5pbXBvcnQgeyBTdGF0dXNTZWxlY3RvciB9IGZyb20gJy4uLy4uLy4uL3N0YXR1cy1zZWxlY3Rvcidcbi8vIFdvcmRpbmdcbi8vIFV0aWxzXG5pbXBvcnQgd2FybkNvbmNhdGVuYXRlZCBmcm9tICcuLi8uLi8uLi8uLi91dGlscy9jb25jYXRlbmF0ZWRTdGF0dXMnXG5pbXBvcnQgZXZlbnRUYXNrUGFuZWwsIHsgQUNUSU9OX1NUT1BfQ09VTlRFUl9USU1FX0tFRVBFUiB9IGZyb20gJy4uL3V0aWxzL2V2ZW50VGFza1BhbmVsJ1xuaW1wb3J0IGlzUGxheUFjdGl2ZSBmcm9tICcuLi91dGlscy9wbGF5J1xuLy8gQ29udGV4dFxuaW1wb3J0IHsgVXNlckNvbnRleHQgfSBmcm9tICcuLi8uLi8uLi8uLi9wcm92aWRlcnMvVXNlclByb3ZpZGVyJ1xuLy8gQ29uc3RhbnRzXG5pbXBvcnQgeyBTTUFMTF9TSVpFLCBMQVJHRV9TSVpFIH0gZnJvbSAnLi4vY29uc3RhbnRzL3Rhc2snXG5pbXBvcnQgeyBTVEFUVVNfRklOSVNIRUQsIExJU1RFTkVSX1RBU0tfRklOSVNIRUQgfSBmcm9tICcuLi9jb25zdGFudHMvc3RhdHVzJ1xuLy8gTGF6eSBpbXBvcnRzXG5jb25zdCBNb2RhbFBvcnRhbCA9IGxhenkoKCkgPT5cbiAgaW1wb3J0KCcuLi8uLi8uLi9tb2RhbC1wb3J0YWwnKS50aGVuKG1vZHVsZSA9PiAoe1xuICAgIGRlZmF1bHQ6IG1vZHVsZS5Nb2RhbFBvcnRhbCxcbiAgfSkpXG4pXG5cbmNvbnN0IFN0YXR1c0NvbnRhaW5lck1lbW8gPSAoe1xuICB0YXNrSWQsXG4gIGdldExpbmtzLFxuICBkYXRhQ291bnRlcixcbiAgaXNMYXJnZVRhc2ssXG4gIHVwZGF0ZVN0YXR1cyxcbiAgY3VycmVudFN0YXR1cyxcbiAgdGFza1RpdGxlID0gJycsXG4gIGhhbmRsZVNob3dFcnJvcixcbn0pID0+IHtcbiAgY29uc3QgeyBpc0NsaWVudCwgc2V0dGluZ3MgfSA9IHVzZUNvbnRleHQoVXNlckNvbnRleHQpXG4gIGNvbnN0IFtsaW5rcywgc2V0TGlua3NdID0gdXNlU3RhdGUoe30pXG4gIGNvbnN0IFtzaG93TW9kYWwsIHNldFNob3dNb2RhbF0gPSB1c2VTdGF0ZShmYWxzZSlcbiAgY29uc3QgW3N0YXR1c1RvVXBkYXRlLCBzZXRTdGF0dXNUb1VwZGF0ZV0gPSB1c2VTdGF0ZSgnJylcbiAgY29uc3QgeyB0IH0gPSB1c2VUcmFuc2xhdGlvbihbJ3Rhc2tfcGFuZWwnLCAnbW9kYWxzJ10pXG5cbiAgY29uc3QgdmVyaWZ5Q29uY2F0ZW5hdGUgPSB1c2VDYWxsYmFjayhcbiAgICAoZGF0YWxpbmtzLCBuZXdTdGF0dXMpID0+IHtcbiAgICAgIC8qKlxuICAgICAgICogRXZhbHVvIHNpIGxhIHRhcmVhIGVzdMOhIGNvbmNhdGVuYWRhLlxuICAgICAgICovXG4gICAgICBpZiAod2FybkNvbmNhdGVuYXRlZChkYXRhbGlua3MpLmhhc0RlcGVuZGVuY2llcykge1xuICAgICAgICAvKipcbiAgICAgICAgICogWWEgcXVlIGxhIHRhcmVhIGVzdMOhIGNvbmNhdGVuYWRhIGd1YXJkbyBlbiB1biBlc3RhZG8gKHN0YXR1c1RvVXBkYXRlKVxuICAgICAgICAgKiBlbCB2YWxvciBkZWwgc3RhdHVzIGEgY2FtYmlhci4gRXN0byBsbyBoYWdvIHBvciBzaSBlbCB1c3VhcmlvIGNhbmNlbGFcbiAgICAgICAgICogdGVybWluYXIgY29uIGxhcyBkZXBlbmRlbmNpYXMuXG4gICAgICAgICAqIE11ZXN0cm8gbW9kYWwgcXVlIGF2aXNhIHF1ZSBsYSB0YXJlYSB0aWVuZSBkZXBlbmRlbmNpYXMuXG4gICAgICAgICAqL1xuICAgICAgICBzZXRTdGF0dXNUb1VwZGF0ZShuZXdTdGF0dXMpXG4gICAgICAgIHNldFNob3dNb2RhbCh0cnVlKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIExhIHRhcmVhIG5vIGVzdMOhIGNvbmNhdGVuYWRhIHkgZW50b25jZXMgbGxhbW8gYSBsYSBmdW5jacOzbiBxdWUgZXZhbHVhXG4gICAgICAgICAqIHNpIGRldGllbmUgZWwgUExBWSB5IHRhbWJpw6luIGVudsOtbyBhIGFjdHVhbGl6YXIgZWwgbnVldm8gc3RhdHVzLlxuICAgICAgICAgKi9cbiAgICAgICAgc3RvcENvdW50ZXIobmV3U3RhdHVzKVxuICAgICAgICBoYW5kbGVUYXNrRmluaXNoZWQobmV3U3RhdHVzKVxuICAgICAgICB1cGRhdGVTdGF0dXMoe1xuICAgICAgICAgIHN0YXR1czogbmV3U3RhdHVzLFxuICAgICAgICB9KVxuICAgICAgfVxuICAgIH0sXG4gICAgW2RhdGFDb3VudGVyXVxuICApXG4gIC8qKlxuICAgKiBEZXRlbmdvIGVsIFBsYXkgc2kgZWwgdXN1YXJpIGNhbWJpbyBkZSBlc3RhZG8gYSBGSU5BTElaQURBLlxuICAgKi9cbiAgY29uc3Qgc3RvcENvdW50ZXIgPSB1c2VDYWxsYmFjayhcbiAgICBuZXdTdGF0dXMgPT4ge1xuICAgICAgaWYgKG5ld1N0YXR1cyA9PT0gU1RBVFVTX0ZJTklTSEVEICYmIGlzUGxheUFjdGl2ZSh0YXNrSWQpKSB7XG4gICAgICAgIC8vIGRpc3BhcmEgZXZlbnRvIHBhcmEgc3RvcGVhciBlbCBjb250YWRvciBlbiBlbCBwYW5lbFxuICAgICAgICBldmVudFRhc2tQYW5lbChBQ1RJT05fU1RPUF9DT1VOVEVSX1RJTUVfS0VFUEVSLCB7XG4gICAgICAgICAgdGFzazogeyBfaWQ6IHRhc2tJZCB9LFxuICAgICAgICB9KVxuICAgICAgfVxuICAgIH0sXG4gICAgW3Rhc2tJZF1cbiAgKVxuXG4gIGNvbnN0IGhhbmRsZVRhc2tGaW5pc2hlZCA9IHVzZUNhbGxiYWNrKFxuICAgIG5ld1N0YXR1cyA9PiB7XG4gICAgICBpZiAobmV3U3RhdHVzID09PSBTVEFUVVNfRklOSVNIRUQgJiYgZGF0YUNvdW50ZXIucGxheURhdGEgJiYgdHlwZW9mIGRhdGFDb3VudGVyLnN0b3AgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgY29uc3QgeyB0YXNrSWQ6IHRhc2tJZFdpdGhQbGF5LCBjdXJyZW50VGltZSwgY291bnRlcklkIH0gPSBkYXRhQ291bnRlci5wbGF5RGF0YVxuICAgICAgICBpZiAoU3RyaW5nKHRhc2tJZCkgPT09IFN0cmluZyh0YXNrSWRXaXRoUGxheSkpIHtcbiAgICAgICAgICBkYXRhQ291bnRlci5zdG9wKHtcbiAgICAgICAgICAgIHRhc2tJZCxcbiAgICAgICAgICAgIGNvdW50ZXJJZCxcbiAgICAgICAgICAgIGN1cnJlbnRUaW1lLFxuICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgICAgLy8gVE9ETzogQ2hhbmdlIHdoZW4gdGhlcmUgaXMgYSBuZXcgbW9kYWwgZm9yIGxvYWRpbmcgaG91cnNcbiAgICAgICAgY29uc3QgdGFza0ZpbmlzaGVkRXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoTElTVEVORVJfVEFTS19GSU5JU0hFRCwge1xuICAgICAgICAgIGRldGFpbDoge1xuICAgICAgICAgICAgdGFza0lkLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pXG4gICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KHRhc2tGaW5pc2hlZEV2ZW50KVxuICAgICAgfVxuICAgIH0sXG4gICAgW2RhdGFDb3VudGVyXVxuICApXG4gIC8qKlxuICAgKiBFbnZpbyBhIGFjdHVhbGl6YXIgZWwgc3RhdHVzIGRlIGxhIHRhcmVhLlxuICAgKi9cbiAgY29uc3QgaGFuZGxlVXBkYXRlU3RhdHVzID0gdXNlQ2FsbGJhY2soXG4gICAgYXN5bmMgbmV3U3RhdHVzID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHsgZGF0YSB9ID0gYXdhaXQgZ2V0TGlua3MoKVxuICAgICAgICBzZXRMaW5rcyhkYXRhLnRhc2tMaW5rcylcbiAgICAgICAgdmVyaWZ5Q29uY2F0ZW5hdGUoZGF0YS50YXNrTGlua3MsIG5ld1N0YXR1cylcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGhhbmRsZVNob3dFcnJvcigpXG4gICAgICB9XG4gICAgfSxcbiAgICBbZGF0YUNvdW50ZXJdXG4gIClcblxuICAvKipcbiAgICogQ29uZmlybWEgcXVlIGVsIHVzdWFyaW8gZGVjaWRpw7Mgcm9tcGVyIGNvbiBsYSBjb25jYXRlbmFjacOzbi5cbiAgICovXG4gIGNvbnN0IGhhbmRsZUFjY2VwdCA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICBjb25zdCBDT05DQVRFTkFURURfVVRJTCA9IHdhcm5Db25jYXRlbmF0ZWQobGlua3MpXG4gICAgc2V0U2hvd01vZGFsKGZhbHNlKVxuICAgIHN0b3BDb3VudGVyKHN0YXR1c1RvVXBkYXRlKVxuICAgIGhhbmRsZVRhc2tGaW5pc2hlZChzdGF0dXNUb1VwZGF0ZSlcbiAgICB1cGRhdGVTdGF0dXMoe1xuICAgICAgc3RhdHVzOiBzdGF0dXNUb1VwZGF0ZSxcbiAgICAgIGxpbmtPcHRpb246IHtcbiAgICAgICAgb3B0aW9uOiBgZGVsZXRlXyR7Q09OQ0FURU5BVEVEX1VUSUwudHlwZX1fbGlua2AsXG4gICAgICAgIGZpbHRlckJ5U3RhdHVzOiBDT05DQVRFTkFURURfVVRJTC5zdGF0dXMsXG4gICAgICAgIGNoYW5nZV90eXBlOiAnc3RhdHVzJyxcbiAgICAgIH0sXG4gICAgfSlcbiAgfSwgW2xpbmtzLCBzdGF0dXNUb1VwZGF0ZSwgZGF0YUNvdW50ZXJdKVxuXG4gIC8qKlxuICAgKiBDaWVycm8gbW9kYWwgZGUgY29uY2F0ZW5hY2nDs24uXG4gICAqL1xuICBjb25zdCBoYW5kbGVDbG9zZU1vZGFsID0gdXNlQ2FsbGJhY2soKCkgPT4gc2V0U2hvd01vZGFsKGZhbHNlKSwgW10pXG5cbiAgY29uc3QgdHJhbnNsYXRlc01vZGFsID0gdXNlTWVtbygoKSA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGFjY2VwdDogdCgnbW9kYWxzOmFjY2VwdCcpLFxuICAgICAgY2FuY2VsOiB0KCdtb2RhbHM6Y2FuY2VsJyksXG4gICAgfVxuICB9LCBbXSlcblxuICBjb25zdCBzdGF0dXNXaWR0aCA9IGlzTGFyZ2VUYXNrID8gTEFSR0VfU0laRSA6IFNNQUxMX1NJWkVcblxuICBjb25zdCBpc0luRGVzaWduU3RhdHVzQWxsb3dlZCA9IHVzZU1lbW8oKCkgPT4gc2V0dGluZ3M/LmFsbG93X2luX2Rlc2lnbl9zdGF0dXMgPT09IHRydWUsIFtzZXR0aW5nc10pXG4gIGNvbnN0IGlzSW5SZXZpZXdTdGF0dXNBbGxvd2VkID0gdXNlTWVtbygoKSA9PiBzZXR0aW5ncz8uYWxsb3dfaW5fcmV2aXNpb25fc3RhdHVzID09PSB0cnVlLCBbc2V0dGluZ3NdKVxuXG4gIHJldHVybiAoXG4gICAgPD5cbiAgICAgIDxTdGF0dXNTZWxlY3RvclxuICAgICAgICB3aWR0aD17NH1cbiAgICAgICAgYWJsZVRvRWRpdD17IWlzQ2xpZW50fVxuICAgICAgICBib3hXaWR0aD17c3RhdHVzV2lkdGh9XG4gICAgICAgIGlzSW5EZXNpZ25TdGF0dXNBbGxvd2VkPXtpc0luRGVzaWduU3RhdHVzQWxsb3dlZH1cbiAgICAgICAgaXNJblJldmlld1N0YXR1c0FsbG93ZWQ9e2lzSW5SZXZpZXdTdGF0dXNBbGxvd2VkfVxuICAgICAgICBjdXJyZW50U3RhdHVzPXtjdXJyZW50U3RhdHVzfVxuICAgICAgICB1cGRhdGVTdGF0dXM9e2hhbmRsZVVwZGF0ZVN0YXR1c31cbiAgICAgIC8+XG4gICAgICA8U3VzcGVuc2UgZmFsbGJhY2s9ezxkaXYgLz59PlxuICAgICAgICB7c2hvd01vZGFsICYmIChcbiAgICAgICAgICA8TW9kYWxQb3J0YWxcbiAgICAgICAgICAgIHZhcmlhbnQ9XCJkYW5nZXJcIlxuICAgICAgICAgICAgY2xvc2VNb2RhbD17aGFuZGxlQ2xvc2VNb2RhbH1cbiAgICAgICAgICAgIHRyYW5zbGF0aW9ucz17dHJhbnNsYXRlc01vZGFsfVxuICAgICAgICAgICAgY2xpY2tCdXR0b25BY2NlcHQ9e2hhbmRsZUFjY2VwdH1cbiAgICAgICAgICAgIGVsZW1lbnRJZD1cIiNtb2RhbHMtcG9ydGFsLXRhc2twYW5lbFwiXG4gICAgICAgICAgICBjbGlja0J1dHRvbkNhbmNlbD17aGFuZGxlQ2xvc2VNb2RhbH1cbiAgICAgICAgICAgIHRpdGxlPXt0KCd0YXNrX3BhbmVsOmNvbmNhdGVuYXRlZF9kZXBlbmRlbmNpZXNfdGl0bGVfbW9kYWwnKX1cbiAgICAgICAgICAgIHRleHRDb250ZW50PXt0KCd0YXNrX3BhbmVsOmNvbmNhdGVuYXRlZF9kZXBlbmRlbmNpZXMnLCB7XG4gICAgICAgICAgICAgIHRhc2tOYW1lOiB0YXNrVGl0bGUsXG4gICAgICAgICAgICB9KX1cbiAgICAgICAgICA+XG4gICAgICAgICAgICA8Yj57dCgndGFza19wYW5lbDpjb25jYXRlbmF0ZWRfZGVwZW5kZW5jaWVzX3F1ZXN0aW9uX21vZGFsJyl9PC9iPlxuICAgICAgICAgIDwvTW9kYWxQb3J0YWw+XG4gICAgICAgICl9XG4gICAgICA8L1N1c3BlbnNlPlxuICAgIDwvPlxuICApXG59XG5cbmV4cG9ydCBjb25zdCBTdGF0dXNDb250YWluZXIgPSBtZW1vKFN0YXR1c0NvbnRhaW5lck1lbW8sIChwcmV2UHJvcHMsIG5leHRQcm9wcykgPT4ge1xuICByZXR1cm4gKFxuICAgIHByZXZQcm9wcy50YXNrVGl0bGUgPT09IG5leHRQcm9wcy50YXNrVGl0bGUgJiZcbiAgICBwcmV2UHJvcHMuY3VycmVudFN0YXR1cyA9PT0gbmV4dFByb3BzLmN1cnJlbnRTdGF0dXMgJiZcbiAgICBwcmV2UHJvcHMuZGF0YUNvdW50ZXIgPT09IG5leHRQcm9wcy5kYXRhQ291bnRlclxuICApXG59KVxuXG5TdGF0dXNDb250YWluZXJNZW1vLnByb3BUeXBlcyA9IHtcbiAgLyoqXG4gICAqIElEIGRlIGxhIHRhcmVhXG4gICAqL1xuICB0YXNrSWQ6IFByb3BUeXBlcy5udW1iZXIuaXNSZXF1aXJlZCxcbiAgLyoqXG4gICAqIENhbGxiYWNrIHF1ZSBvYnRpZW5lIGxvcyBsaW5rcyBkZSBsYSB0YXJlYVxuICAgKi9cbiAgZ2V0TGlua3M6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIC8qKlxuICAgKiBDYWxsYmFjayBxdWUgZWplY3V0YSBhbCBhY3R1YWxpemFyIGVsIGVzdGFkb1xuICAgKi9cbiAgdXBkYXRlU3RhdHVzOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICAvKipcbiAgICogU3RhdHVzIGFjdHVhbFxuICAgKi9cbiAgY3VycmVudFN0YXR1czogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuICAvKipcbiAgICogVMOtdHVsbyBkZSBsYSB0YXJlYVxuICAgKi9cbiAgdGFza1RpdGxlOiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG4gIC8qKlxuICAgKiBDYWxsYmFjayBwYXJhIG1vc3RyYXIgZWwgYWxlcnQgZ2VuZXJpY28gZGUgZXJyb3JcbiAgICovXG4gIGhhbmRsZVNob3dFcnJvcjogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgLyoqXG4gICAqIEluZGljYSBzaSBsYSB0YXJlYSB0ZW5kcmEgbG9zIGVzdGlsb3MgZGVsIHJvdyBncmFuZGUgbyBub1xuICAgKi9cbiAgaXNMYXJnZVRhc2s6IFByb3BUeXBlcy5ib29sLmlzUmVxdWlyZWQsXG4gIC8qKlxuICAgKiBEYXRvcyBuZWNlc2FyaW9zIHBhcmEgZWwgUGxheS9TdG9wXG4gICAqL1xuICBkYXRhQ291bnRlcjogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkLFxufVxuIl0sIm1hcHBpbmdzIjoieXVEQWdCTUEsWUFBVyxDQUFHLEdBQUFDLFdBQUksRUFBQyxpQkFDdkIsMEVBQU8sdUJBQXVCLEtBQUVDLElBQUksQ0FBQyxTQUFBQyxDQUFNLFFBQUssQ0FDOUNDLE9BQU8sQ0FBRUQsQ0FBTSxDQUFDSCxXQUNsQixDQUFDLENBQUMsQ0FBQyxFQUNKLENBRUtLLG1CQUFtQixDQUFHLFdBU3RCLElBUkpDLEVBQU0sR0FBTkEsTUFBTSxDQUNOQyxDQUFRLEdBQVJBLFFBQVEsQ0FDUkMsQ0FBVyxHQUFYQSxXQUFXLENBQ1hDLENBQVcsR0FBWEEsV0FBVyxDQUNYQyxDQUFZLEdBQVpBLFlBQVksQ0FDWkMsQ0FBYSxHQUFiQSxhQUFhLEtBQ2JDLFNBQVMsQ0FBVEEsQ0FBUyxZQUFHLEVBQUUsR0FDZEMsQ0FBZSxHQUFmQSxlQUFlLEdBRWdCLEdBQUFDLGlCQUFVLEVBQUNDLHlCQUFXLENBQUMsQ0FBOUNDLENBQVEsR0FBUkEsUUFBUSxDQUFFQyxDQUFRLEdBQVJBLFFBQVEsR0FDQSxHQUFBQyxlQUFRLEVBQUMsQ0FBQyxDQUFDLENBQUMsb0NBQS9CQyxDQUFLLE1BQUVDLENBQVEsUUFDWSxHQUFBRixlQUFRLEtBQU8sb0NBQTFDRyxDQUFTLE1BQUVDLENBQVksUUFDYyxHQUFBSixlQUFRLEVBQUMsRUFBRSxDQUFDLG9DQUFqREssQ0FBYyxNQUFFQyxDQUFpQixRQUMxQixHQUFB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